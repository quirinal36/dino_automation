# 챕터 3: 화면 캡처

> "봇의 눈을 만들자"

---

## 학습 목표

- Pillow 라이브러리의 ImageGrab 모듈을 이해한다
- 화면 전체를 캡처하는 방법을 배운다
- 캡처한 이미지를 파일로 저장한다
- 이미지의 기본 속성(크기, 모드)을 확인한다

---

## Pillow란?

### 소개

**Pillow**는 Python에서 이미지를 다루는 가장 대표적인 라이브러리입니다.

원래 **PIL**(Python Imaging Library)이라는 이름이었지만, 업데이트가 중단되어 커뮤니티에서 **Pillow**라는 이름으로 새롭게 개발을 이어가고 있습니다.

### 우리가 사용할 기능

Pillow는 수많은 기능을 제공하지만, 우리는 딱 하나만 사용합니다:

**`ImageGrab.grab()`** - 화면 캡처

---

## 화면 캡처의 원리

### 컴퓨터 화면이란?

컴퓨터 화면은 수많은 **픽셀(pixel)**의 집합입니다.

```
┌─────────────────────────────────┐
│ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ │  ← 픽셀들의 행
│ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ │
│ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ │
│ ...                             │
└─────────────────────────────────┘
```

- **1920x1080 해상도**: 가로 1920개, 세로 1080개 픽셀
- 각 픽셀은 색상 정보를 가짐

### 화면 캡처란?

현재 화면의 모든 픽셀 정보를 읽어서 이미지 데이터로 저장하는 것입니다.

---

## 좌표 시스템

### 화면 좌표

컴퓨터 화면의 좌표는 **왼쪽 위가 원점(0, 0)**입니다.

```
(0, 0) ─────────────────────────► X축
   │
   │
   │
   │
   │
   ▼
  Y축                        (1919, 1079)
```

- X 좌표: 오른쪽으로 갈수록 증가
- Y 좌표: **아래로 갈수록 증가** (주의!)

---

## 실습: 첫 화면 캡처

### 기본 구조

```python
# 힌트 1: ImageGrab 모듈 불러오기
from PIL import ______

# 힌트 2: 화면 캡처하기
screenshot = ______.grab()

# 힌트 3: 결과 확인
print(type(screenshot))
```

### 알아야 할 것

- `ImageGrab`은 PIL(Pillow)의 하위 모듈입니다
- `grab()` 함수는 인자 없이 호출하면 전체 화면을 캡처합니다
- 반환값은 PIL의 `Image` 객체입니다

---

## 이미지 속성 확인하기

캡처한 이미지의 정보를 확인할 수 있습니다:

### 이미지 크기

```python
# 힌트: size 속성 사용
print(screenshot.______)  # (가로, 세로) 튜플 반환
```

### 이미지 모드

```python
# 힌트: mode 속성 사용
print(screenshot.______)  # 'RGB' 등의 문자열 반환
```

**이미지 모드 종류:**
- `'RGB'`: 빨강, 초록, 파랑 3채널 (일반적인 컬러 이미지)
- `'RGBA'`: RGB + 투명도(Alpha)
- `'L'`: 그레이스케일 (흑백)

---

## 이미지 저장하기

캡처한 이미지를 파일로 저장할 수 있습니다:

```python
# 힌트: save() 메서드 사용
screenshot.______("my_screenshot.png")
```

### 지원하는 형식

- `.png`: 무손실 압축, 권장
- `.jpg` / `.jpeg`: 손실 압축, 파일 크기 작음
- `.bmp`: 압축 없음, 파일 크기 큼

---

## 생각해보기

### 질문 1: 캡처에 시간이 걸린다면?

화면 캡처가 0.1초 걸린다고 가정하면:
- 1초에 최대 몇 번 캡처할 수 있을까요?
- 게임 자동화에 충분할까요?

### 질문 2: 메모리 사용량

1920x1080 RGB 이미지:
- 픽셀 수: 1920 × 1080 = ?
- 각 픽셀당 3바이트 (R, G, B)
- 총 메모리: ? 바이트 = ? MB

### 질문 3: 듀얼 모니터

컴퓨터에 모니터가 2개 연결되어 있다면, `grab()`은 어떤 화면을 캡처할까요?

---

## 실습 과제

### Exercise 3.1: 첫 스크린샷

아래 힌트를 참고해서 화면을 캡처하고 저장하는 스크립트를 작성하세요.

**파일명**: `capture_test.py`

```python
# 1. 필요한 모듈 가져오기
from PIL import ______

# 2. 화면 캡처
screenshot = ______

# 3. 크기 출력
print(f"화면 크기: {______}")

# 4. 모드 출력
print(f"이미지 모드: {______}")

# 5. 파일로 저장
______
print("스크린샷이 저장되었습니다!")
```

### Exercise 3.2: 크기 계산

스크립트 실행 후 출력된 화면 크기를 바탕으로:
1. 총 픽셀 수를 계산하세요
2. 메모리 사용량(MB)을 계산하세요

### Exercise 3.3: 연속 캡처

3초 후에 두 번째 스크린샷을 찍는 스크립트를 작성하세요.

**힌트:**
```python
import time

# 첫 번째 캡처
screenshot1 = ______
screenshot1.save("screenshot_1.png")
print("첫 번째 캡처 완료")

# 3초 대기
time.______(3)

# 두 번째 캡처
screenshot2 = ______
screenshot2.save("screenshot_2.png")
print("두 번째 캡처 완료")
```

### Exercise 3.4: 캡처 시간 측정

화면 캡처에 걸리는 시간을 측정하세요.

**힌트:**
```python
import time

start = time.______()
screenshot = ImageGrab.grab()
end = time.______()

elapsed = end - start
print(f"캡처 시간: {elapsed:.4f}초")
print(f"초당 최대 캡처 횟수: {1/elapsed:.1f}회")
```

---

## 예상 결과

### Exercise 3.1 실행 결과 예시

```
화면 크기: (1920, 1080)
이미지 모드: RGB
스크린샷이 저장되었습니다!
```

### Exercise 3.4 실행 결과 예시

```
캡처 시간: 0.0312초
초당 최대 캡처 횟수: 32.1회
```

---

## 핵심 정리

| 개념 | 설명 |
|------|------|
| `ImageGrab.grab()` | 전체 화면을 캡처하여 Image 객체 반환 |
| `image.size` | 이미지 크기 (가로, 세로) 튜플 |
| `image.mode` | 이미지 색상 모드 ('RGB' 등) |
| `image.save(path)` | 이미지를 파일로 저장 |

### 좌표 시스템

```
(0, 0) = 왼쪽 위
X → 오른쪽으로 증가
Y ↓ 아래로 증가
```

---

## 체크포인트

- [ ] `ImageGrab.grab()`으로 화면을 캡처할 수 있다
- [ ] 캡처한 이미지의 크기와 모드를 확인할 수 있다
- [ ] 이미지를 파일로 저장할 수 있다
- [ ] 캡처 시간을 측정할 수 있다

---

## 다음 챕터 미리보기

**챕터 4: 이미지 배열**에서는 캡처한 이미지를 NumPy 배열로 변환합니다. 이미지가 실제로 숫자들의 집합임을 이해하고, 개별 픽셀에 접근하는 방법을 배웁니다.

[다음 챕터로 이동 →](../04-이미지배열/chapter-04-image-arrays.md)
